/** @license Copyright (c) Microsoft Corporation. All rights reserved. */
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __},MscrmControls;(function(MscrmControls){var BulletGraph;(function(BulletGraph_1){"use strict";var ExceptionHandler=MscrmCommon.ErrorHandling.ExceptionHandler,BulletGraphControl=function(_super){__extends(BulletGraphControl,_super);function BulletGraphControl(){_super.call(this);this.isVisible=true}BulletGraphControl.prototype.initCore=function(context){var _this=this;this.bulletGraphControl=this.createControlOnDOM();this.bulletGraphControl.valueChanged.addHandler(function(){return _this.notifyEnabledControlOutputChanged.apply(_this)});this.setCustomStyles(context.theming)};BulletGraphControl.prototype.updateCore=function(context){this.throwIfPropertyBagParametersNotValid(context);this.processPropertyBagValues(context);this.updateControl(context);this.refresh();this.fixVisibility(context);var formattedValue=MscrmCommon.ControlUtils.NumericInterval.getFormattedValue(context.parameters.value);MscrmCommon.ControlUtils.NumericInterval.setValueContainer(this.valueContainer,formattedValue)};BulletGraphControl.prototype.showDefaultLabelCore=function(context){return MscrmCommon.ControlUtils.Property.isNullOrEmpty(context.parameters.value)};BulletGraphControl.prototype.getOutputsCore=function(){var result={value:this.bulletGraphControl.value};return result};BulletGraphControl.prototype.destroyCore=function(){if(this.isControlInitialized){this.bulletGraphControl.valueChanged.removeAllHandlers();this.bulletGraphControl.dispose()}this.bulletGraphControl=null;$(this.container).empty()};BulletGraphControl.prototype.isControlDisabled=function(){return this.bulletGraphControl.disabled};BulletGraphControl.prototype.updateControl=function(context){this.bulletGraphControl.disabled=context.mode.isControlDisabled;this.bulletGraphControl.origin=context.parameters.min.raw;this.bulletGraphControl.min=context.parameters.min.raw;this.bulletGraphControl.max=context.parameters.max.raw;this.bulletGraphControl.value=context.parameters.value.raw;this.bulletGraphControl.target=context.parameters.target.raw;if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.parameters.good.raw))this.bulletGraphControl.good=context.parameters.good.raw;if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.parameters.bad.raw))this.bulletGraphControl.bad=context.parameters.bad.raw;if(context.parameters.target.raw>context.parameters.max.raw||context.parameters.target.raw<context.parameters.min.raw)this.bulletGraphControl._rngTarget.color="rgba(0, 0, 0, 0)"};BulletGraphControl.prototype.refresh=function(){this.bulletGraphControl.refresh(true)};BulletGraphControl.prototype.createControlOnDOM=function(){var bulletGraphWrapperContainer=_super.prototype.createWrapperContainer.call(this);$(bulletGraphWrapperContainer).addClass(BulletGraphControl.bulletGraphContainerClass);return new wijmo.gauge.BulletGraph(bulletGraphWrapperContainer)};BulletGraphControl.prototype.throwIfPropertyBagParametersNotValid=function(context){MscrmCommon.ControlUtils.NumericInterval.throwIfNullDataBagParameters(context,false);MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.parameters.target)&&ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"target"))};BulletGraphControl.prototype.processPropertyBagValues=function(context){MscrmCommon.ControlUtils.NumericInterval.processPropertyBagValues(context,this.notificationHandler,false);this.handleOptionalProperties(context);var min=context.parameters.min,target=context.parameters.target;if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(target.raw))target.raw=min.raw};BulletGraphControl.prototype.handleOptionalProperties=function(context){var bad=context.parameters.bad,good=context.parameters.good,min=context.parameters.min;if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(bad))context.parameters.bad=MscrmCommon.ControlUtils.NumericInterval.createOptionalNumberPropery(min.raw);if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(good))context.parameters.good=MscrmCommon.ControlUtils.NumericInterval.createOptionalNumberPropery(min.raw)};BulletGraphControl.prototype.setCustomStyles=function(theming){this.bulletGraphControl._rngBad.color=BulletGraphControl.badBarColor;this.bulletGraphControl._rngGood.color=BulletGraphControl.goodBarColor;this.bulletGraphControl._rngTarget.color=MscrmCommon.ThemingHelper.getProcessControlColor(theming);this.bulletGraphControl._rngTarget.thickness=1;this.bulletGraphControl.pointer.thickness=this.getPointerThickness();this.bulletGraphControl.showText=wijmo.gauge.ShowText.None;this.bulletGraphControl.hasShadow=false;var theme=BulletGraphControl.buildTheme(theming);MscrmCommon.ThemingHelper.injectStyle(this.container,theme)};BulletGraphControl.buildTheme=function(theming){return MscrmCommon.ControlUtils.String.Format("\t\t\t\t.crm-bullet-graph-container .crm-bullet-label {\t\t\t\t\tfont-family: {0};\t\t\t\t\tcolor:       {1};\t\t\t\t\tfont-size:   {2};\t\t\t\t}",MscrmCommon.ThemingHelper.getFontFamily(theming),MscrmCommon.ThemingHelper.getFontColor(theming),MscrmCommon.ThemingHelper.getFontSize(theming))};BulletGraphControl.prototype.getPointerThickness=function(){return .272727};BulletGraphControl.prototype.fixVisibility=function(context){var _this=this;if(this.isVisible!==context.mode.isVisible){this.isVisible=context.mode.isVisible;this.isVisible&&window.setTimeout(function(){_this.refresh()},BulletGraphControl.visibilityChangeRedrawTimeout)}};BulletGraphControl.bulletGraphContainerClass="crm-wijmo-bulletgraph-container";BulletGraphControl.badBarColor="rgba(69, 140, 160, 0.6)";BulletGraphControl.goodBarColor="rgba(60, 132, 155, 0.3)";BulletGraphControl.visibilityChangeRedrawTimeout=100;return BulletGraphControl}(MscrmCommon.FieldControlBase);BulletGraph_1.BulletGraphControl=BulletGraphControl})(BulletGraph=MscrmControls.BulletGraph||(MscrmControls.BulletGraph={}))})(MscrmControls||(MscrmControls={}))