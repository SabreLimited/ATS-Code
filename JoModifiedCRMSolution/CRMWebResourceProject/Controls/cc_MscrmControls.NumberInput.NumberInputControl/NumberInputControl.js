/** @license Copyright (c) Microsoft Corporation. All rights reserved. */
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __},MscrmControls;(function(MscrmControls){var NumberInput;(function(NumberInput){"use strict";var ErrorCode=MscrmCommon.ErrorHandling.ErrorCode,ExceptionHandler=MscrmCommon.ErrorHandling.ExceptionHandler,StringUtil=MscrmCommon.ControlUtils.String,NumberInputControl=function(_super){__extends(NumberInputControl,_super);function NumberInputControl(){_super.call(this);this.preventEditModePanoramaEvents=true}NumberInputControl.prototype.initCore=function(context){var _this=this;this.numberInputControl=this.createControlOnDOM();this.numberInputControl.valueChanged.addHandler(function(){return _this.notifyEnabledControlOutputChanged.apply(_this)});this.numberInputControl.hostElement.classList.add(NumberInputControl.CustomWrapperClassName);this.numberInputControl._ehSelectAll=this.selectAllContent.bind(this);this.applyStyling(context.theming)};NumberInputControl.prototype.updateCore=function(context){this.validateInputDataBag(context);this.processPropertyBagValues(context);this.numberInputControl.required=false;this.numberInputControl.inputType="text";this.numberInputControl.placeholder=MscrmCommon.CommonControl.DefaultValueLabel;this.numberInputControl.format=MscrmCommon.ControlUtils.WijmoGlobalization.getFormat(context);this.numberInputControl.min=context.parameters.value.attributes.minValue;this.numberInputControl.max=context.parameters.value.attributes.maxValue;this.numberInputControl.step=context.parameters.step.raw;this.numberInputControl.value=context.parameters.value.raw;this.numberInputControl.refresh(true);this.setButtonStyles()};NumberInputControl.prototype.renderEditMode=function(context){_super.prototype.renderEditMode.call(this,context);this.shouldNotifyOutputChanged=true;this.eventGuard.preventEditModeTransitionFocus()};NumberInputControl.prototype.getOutputsCore=function(){var result={value:this.numberInputControl.value};return result};NumberInputControl.prototype.destroyCore=function(){if(this.isControlInitialized){this.numberInputControl.valueChanged.removeAllHandlers();this.numberInputControl.dispose()}this.numberInputControl=null;$(this.container).empty()};NumberInputControl.prototype.selectAllContent=function(){wijmo.setSelectionRange(this.numberInputControl.inputElement,0,this.numberInputControl.inputElement.value.length)};NumberInputControl.prototype.validateInputDataBag=function(context){context.utils.isNullOrUndefined(context.parameters.value)&&ExceptionHandler.throwException(StringUtil.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"value"));context.utils.isNullOrUndefined(context.parameters.value.attributes)&&ExceptionHandler.throwException(StringUtil.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"value.attributes"));context.utils.isNullOrUndefined(context.parameters.value.attributes.type)&&ExceptionHandler.throwException(StringUtil.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"value.attributes.type"));context.utils.isNullOrUndefined(context.parameters.value.attributes.minValue)&&ExceptionHandler.throwException(StringUtil.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"value.attributes.minValue"));context.utils.isNullOrUndefined(context.parameters.value.attributes.maxValue)&&ExceptionHandler.throwException(StringUtil.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"value.attributes.maxValue"))};NumberInputControl.prototype.processPropertyBagValues=function(context){this.notificationHandler.clear(ErrorCode.ValueOutOfRangeId);var minValue=context.parameters.value.attributes.minValue,maxValue=context.parameters.value.attributes.maxValue,stepValue=context.parameters.step,value=context.parameters.value;maxValue&&minValue&&maxValue<minValue&&ExceptionHandler.throwException(MscrmCommon.CommonControl.InvalidInputParamMinMax);if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(value)&&(value.raw<minValue||value.raw>maxValue)){var errMessage=StringUtil.Format(context.resources.getString(ErrorCode.ValueOutOfRangeId),minValue,maxValue);this.notificationHandler.notify(errMessage,ErrorCode.ValueOutOfRangeId)}if(!MscrmCommon.ControlUtils.NumericInterval.isNumber(stepValue.raw)||!MscrmCommon.ControlUtils.NumericInterval.isNumeric(stepValue.raw)||stepValue.raw>maxValue-minValue||stepValue.raw<0){var precision=MscrmCommon.ControlUtils.NumericInterval.getPrecision(context.parameters.value);stepValue.raw=precision?Math.pow(10,-precision):1}};NumberInputControl.prototype.setButtonStyles=function(){this.numberInputControl._btnDn.classList.add(NumberInputControl.EnabledButtonsClassName);this.numberInputControl._btnUp.classList.add(NumberInputControl.EnabledButtonsClassName)};NumberInputControl.prototype.createControlOnDOM=function(){return new wijmo.input.InputNumber(_super.prototype.createWrapperContainer.call(this))};NumberInputControl.prototype.applyStyling=function(theming){var themeFormat=".crm-wijmo-numberinput-btn-enabled {\t\t\t\t\t\t\t\t\tbackground-color: {0};\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t.crm-wijmo-numberinput .wj-btn {\t\t\t\t\t\t\t\t\tfont-family: {1};\t\t\t\t\t\t\t\t}",theme=StringUtil.Format(themeFormat,MscrmCommon.ThemingHelper.getProcessNonSelectedColor(theming),MscrmCommon.ThemingHelper.getFontFamily(theming));MscrmCommon.ThemingHelper.injectStyle(this.container,theme)};NumberInputControl.InvalidInputParamMinMax="Min and max values do not bound a valid interval.";NumberInputControl.InvalidInputParamValue="Value for the control is not within the desired interval.";NumberInputControl.CustomWrapperClassName="crm-wijmo-numberinput";NumberInputControl.EnabledButtonsClassName="crm-wijmo-numberinput-btn-enabled";return NumberInputControl}(MscrmCommon.FieldControlBase);NumberInput.NumberInputControl=NumberInputControl})(NumberInput=MscrmControls.NumberInput||(MscrmControls.NumberInput={}))})(MscrmControls||(MscrmControls={}))