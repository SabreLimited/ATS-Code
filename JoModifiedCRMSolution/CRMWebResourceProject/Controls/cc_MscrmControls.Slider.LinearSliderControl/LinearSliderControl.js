/** @license Copyright (c) Microsoft Corporation. All rights reserved. */
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __},MscrmControls;(function(MscrmControls){var Slider;(function(Slider){"use strict";var Utils=MscrmCommon.ControlUtils,LinearSliderControl=function(_super){__extends(LinearSliderControl,_super);function LinearSliderControl(){_super.call(this);this.preventEditModePanoramaEvents=true}Object.defineProperty(LinearSliderControl.prototype,"value",{"get":function(){return Utils.Object.isNullOrUndefined(this.sliderDomElement)?null:parseInt(this.sliderDomElement.val())},enumerable:true,configurable:true});Object.defineProperty(LinearSliderControl.prototype,"min",{"get":function(){return Utils.Object.isNullOrUndefined(this.sliderDomElement)?null:parseInt(this.sliderDomElement.attr("min"))},enumerable:true,configurable:true});Object.defineProperty(LinearSliderControl.prototype,"max",{"get":function(){return Utils.Object.isNullOrUndefined(this.sliderDomElement)?null:parseInt(this.sliderDomElement.attr("max"))},enumerable:true,configurable:true});LinearSliderControl.prototype.initCore=function(context){Utils.NumericInterval.throwIfNullDataBagParameters(context);Utils.NumericInterval.processPropertyBagValues(context,this.notificationHandler);this.sliderDomElement=this.createSliderDomElement(this.container);this.bindSliderHandles(context);var theme=LinearSliderControl.buildTheme(context.theming);MscrmCommon.ThemingHelper.injectStyle(this.container,theme)};LinearSliderControl.prototype.updateCore=function(context){var initialStepValue=0,hasStep=!Utils.Object.isNullOrUndefined(context.parameters.step);if(hasStep)initialStepValue=Math.round(context.parameters.step.raw);Utils.NumericInterval.throwIfNullDataBagParameters(context);Utils.NumericInterval.processPropertyBagValues(context,this.notificationHandler);if(hasStep&&context.parameters.value.raw%initialStepValue!==0)context.parameters.step.raw=initialStepValue;$(this.valueContainer).hide();this.updateControl(context)};LinearSliderControl.prototype.showDefaultLabelCore=function(context){this.eventGuard.stopPreventingFocus();return Utils.Property.isNullOrEmpty(context.parameters.value)};LinearSliderControl.prototype.renderReadMode=function(context){_super.prototype.renderReadMode.call(this,context);this.eventGuard.stopPreventingFocus();this.refresh();this.disableControlInteraction();if(context.mode.isControlDisabled)this.setDisabledCustomStyle(this.sliderDomElement);else this.setReadOnlyCustomStyle(this.sliderDomElement)};LinearSliderControl.prototype.renderEditMode=function(context){_super.prototype.renderEditMode.call(this,context);this.sliderDomElement.slider({disabled:false});this.setEditCustomStyle(this.sliderDomElement);this.refresh();this.shouldNotifyOutputChanged=true;this.eventGuard.preventEditModeTransitionFocus()};LinearSliderControl.prototype.getOutputsCore=function(){return {value:this.value}};LinearSliderControl.prototype.destroyCore=function(){if(!this.isControlInitialized)return;if(Utils.Object.isNullOrUndefined(this.sliderDomElement)){this.sliderDomElement.off();this.sliderDomElement.slider(MscrmCommon.MethodConstants.Destroy);this.sliderDomElement=null}};LinearSliderControl.prototype.isControlDisabled=function(){return this.sliderDomElement.prop(MscrmCommon.AttributeConstants.Disabled)};LinearSliderControl.prototype.createSliderDomElement=function(container){var inputHtmlFormat="<input class='{0}' type='text' data-type='range' data-theme='{1}' data-highlight='true'>",inputHtml=Utils.String.Format(inputHtmlFormat,MscrmCommon.CommonControl.ClassName,LinearSliderControl.jQueryMobileThemeSwatch),sliderDomElement=$(inputHtml).appendTo(container).slider().textinput();this.setEditCustomStyle(sliderDomElement);return sliderDomElement};LinearSliderControl.prototype.isControlValueValid=function(){var val=this.value;return val!==null&&this.max!=null&&this.min!==null&&Utils.NumericInterval.isNumeric(val)&&val>=this.min&&val<=this.max};LinearSliderControl.prototype.bindSliderHandles=function(context){var _this=this,validateControlValue=function(){if(_this.isControlValueValid()){_this.notificationHandler.clear(MscrmCommon.ErrorHandling.ErrorCode.ValueOutOfRangeId);_this.notifyEnabledControlOutputChanged.apply(_this)}};this.sliderDomElement.on(LinearSliderControl.SlideStopEventName,function(){validateControlValue()});this.sliderDomElement.on(MscrmCommon.EventConstants.FocusEvents,function(event){if(event.type===MscrmCommon.EventConstants.FocusIn)$(event.target).on(MscrmCommon.EventConstants.Change,function(){validateControlValue()});else $(event.target).off(MscrmCommon.EventConstants.Change)})};LinearSliderControl.prototype.updateControl=function(context){this.sliderDomElement.attr({min:context.parameters.min.raw,max:context.parameters.max.raw,step:context.parameters.step.raw,value:context.parameters.value.raw});this.sliderDomElement.val(context.parameters.value.raw.toString())};LinearSliderControl.prototype.refresh=function(){this.sliderDomElement.slider.call(this.sliderDomElement,MscrmCommon.MethodConstants.Refresh,undefined,true,false)};LinearSliderControl.prototype.disableControlInteraction=function(){this.sliderDomElement.slider({disabled:true});$(this.container).find(LinearSliderControl.HandleElement).toggleClass(LinearSliderControl.DisabledHandleClass,false).attr(LinearSliderControl.DisabledHandleAttribute,"false");$(this.container).find(LinearSliderControl.HandleSelector).toggleClass(LinearSliderControl.DisabledButtonClass,false);this.sliderDomElement.css("display","block")};LinearSliderControl.prototype.setEditCustomStyle=function(sliderDomElement){this.toggleCustomStyles(sliderDomElement,LinearSliderControl.CustomWrapperReadOnlyClass,false);this.toggleCustomStyles(sliderDomElement,LinearSliderControl.CustomWrapperDisabledClass,false);this.toggleCustomStyles(sliderDomElement,LinearSliderControl.CustomWrapperClass,true)};LinearSliderControl.prototype.setReadOnlyCustomStyle=function(sliderDomElement){this.toggleCustomStyles(sliderDomElement,LinearSliderControl.CustomWrapperClass,false);this.toggleCustomStyles(sliderDomElement,LinearSliderControl.CustomWrapperDisabledClass,false);this.toggleCustomStyles(sliderDomElement,LinearSliderControl.CustomWrapperReadOnlyClass,true)};LinearSliderControl.prototype.setDisabledCustomStyle=function(sliderDomElement){this.toggleCustomStyles(sliderDomElement,LinearSliderControl.CustomWrapperClass,false);this.toggleCustomStyles(sliderDomElement,LinearSliderControl.CustomWrapperReadOnlyClass,false);this.toggleCustomStyles(sliderDomElement,LinearSliderControl.CustomWrapperDisabledClass,true)};LinearSliderControl.prototype.toggleCustomStyles=function(sliderDomElement,customWrapperClass,toggle){var wrapperElement=sliderDomElement.parent();wrapperElement.toggleClass(customWrapperClass,toggle)};LinearSliderControl.buildTheme=function(theming){var color=MscrmCommon.ThemingHelper.getProcessControlColor(theming),fontColor=MscrmCommon.ThemingHelper.getFontColor(theming),fontSize=MscrmCommon.ThemingHelper.getFontSize(theming),fontFamily=MscrmCommon.ThemingHelper.getFontFamily(theming),styleFormat=".crm-jqm-slider .ui-slider-track .ui-btn.ui-slider-handle, \t\t\t\t.crm-jqm-slider-readonly .ui-slider-track .ui-btn.ui-slider-handle, \t\t\t\t.crm-jqm-slider-disabled .ui-slider-track .ui-btn.ui-slider-handle,\t\t\t\t.crm-jqm-slider-readonly .ui-slider-bg, \t\t\t\t.crm-jqm-slider-disabled .ui-slider-bg {\t\t\t\t\tbackground-color: {0};\t\t\t\t}\t\t\t\t.crm-jqm-slider .ui-slider-bg { \t\t\t\t\tbackground-color: {0};\t\t\t\t}\t\t\t\t.crm-jqm-slider-readonly .ui-slider-input, \t\t\t\t.crm-jqm-slider-disabled .ui-slider-input, \t\t\t\t.crm-jqm-slider .ui-slider-input {\t\t\t\t\tcolor: {1}; \t\t\t\t\tfont-size: {2}; \t\t\t\t\tfont-family: {3};\t\t\t\t}\t\t\t\t.crm-jqm-slider-readonly .ui-slider-input { \t\t\t\t\t-webkit-text-fill-color: {1}; \t\t\t\t\topacity: 1;\t\t\t\t}\t\t\t\t";return Utils.String.Format(styleFormat,color,fontColor,fontSize,fontFamily)};LinearSliderControl.SlideStopEventName="slidestop";LinearSliderControl.CustomWrapperClass="crm-jqm-slider";LinearSliderControl.CustomWrapperClassSelector=".crm-jqm-slider";LinearSliderControl.CustomWrapperReadOnlyClass="crm-jqm-slider-readonly";LinearSliderControl.CustomWrapperDisabledClass="crm-jqm-slider-disabled";LinearSliderControl.HandleElement="div[role='application']";LinearSliderControl.DisabledHandleClass="ui-state-disabled";LinearSliderControl.DisabledHandleAttribute="aria-disabled";LinearSliderControl.DisabledButtonClass="ui-btn-c-disabled";LinearSliderControl.HandleSelector=".ui-slider-handle";LinearSliderControl.jQueryMobileThemeSwatch="c";return LinearSliderControl}(MscrmCommon.FieldControlBase);Slider.LinearSliderControl=LinearSliderControl})(Slider=MscrmControls.Slider||(MscrmControls.Slider={}))})(MscrmControls||(MscrmControls={}))